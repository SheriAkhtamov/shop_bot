import asyncio
from sqlalchemy import select
from app.database.core import async_session_maker
from app.database.models import Category

# –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ —Ç–≤–æ–µ–≥–æ –¢–ó
CATEGORIES_DATA = [
    # üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    "–°—Ç–∞–∫–∞–Ω—ã", "–¢–∞—Ä–µ–ª–∫–∏", "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –µ–¥—ã", "–°—Ç–æ–ª–æ–≤—ã–µ –ø—Ä–∏–±–æ—Ä—ã", "–ö—Ä—ã—à–∫–∏", "–°–∞–ª—Ñ–µ—Ç–∫–∏ –∏ –±—É–º–∞–∂–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è",
    # üîπ –ü–∞–∫–µ—Ç—ã –∏ —É–ø–∞–∫–æ–≤–∫–∞
    "–ö—Ä–∞—Ñ—Ç-–ø–∞–∫–µ—Ç—ã", "–ü–∞–∫–µ—Ç—ã —Å —Ä—É—á–∫–∞–º–∏", "–ü–∞–∫–µ—Ç—ã –±–µ–∑ —Ä—É—á–µ–∫", "–£–ø–∞–∫–æ–≤–∫–∞ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏",
    # üîπ –ü–æ –º–∞—Ç–µ—Ä–∏–∞–ª—É
    "–ë—É–º–∞–∂–Ω–∞—è –ø–æ—Å—É–¥–∞", "–ü–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è –ø–æ—Å—É–¥–∞", "–≠–∫–æ–ª–æ–≥–∏—á–Ω–∞—è –ø–æ—Å—É–¥–∞ (–∫—Ä–∞—Ñ—Ç, –±–∏–æ)", "–ê–ª—é–º–∏–Ω–∏–µ–≤–∞—è –ø–æ—Å—É–¥–∞",
    # üîπ –î–ª—è –±–∏–∑–Ω–µ—Å–∞
    "–î–ª—è –∫–∞—Ñ–µ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ (HoReCa)", "–î–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã", "–î–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –∫–µ–π—Ç–µ—Ä–∏–Ω–≥–∞",
    # üîπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
    "–ù–∞–±–æ—Ä—ã", "–ù–æ–≤–∏–Ω–∫–∏", "–ê–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏"
]

async def init_cats():
    async with async_session_maker() as session:
        print("‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...")
        
        for cat_name in CATEGORIES_DATA:
            stmt = select(Category.id).where(Category.name_ru == cat_name).limit(1)
            result = await session.execute(stmt)
            if result.scalar_one_or_none():
                continue
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é
            # –ü–æ–∫–∞ —Å—Ç–∞–≤–∏–º name_uz —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ name_ru (–ø–æ—Ç–æ–º –∏–∑–º–µ–Ω–∏—à—å)
            new_cat = Category(name_ru=cat_name, name_uz=cat_name)
            session.add(new_cat)
            print(f"‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {cat_name}")
        
        await session.commit()
        print("üèÅ –ì–æ—Ç–æ–≤–æ!")

if __name__ == "__main__":
    asyncio.run(init_cats())
